<div class="flex-1 min-h-0 overflow-auto w-full h-full">
  @if (loading()) {
    <p class="px-4 py-2 text-sm text-gray-400">Loading cryptocurrencies...</p>
  } @else if (error()) {
    <p class="px-4 py-2 text-sm text-red-400">
      {{ error() }}
    </p>
  } @else {
    <table class="min-w-full w-full table-auto border-collapse">
      <thead class="sticky top-0 bg-black/70">
        <tr>
          @for (column of columns; track column.key) {
            <th
              app-table-header
              [columnKey]="column.key"
              [label]="column.label"
              [align]="column.align"
              [additionalClasses]="column.additionalClasses || ''"
              [sortable]="column.sortable"
              [isSortedBy]="isSortedBy(column.key)"
              [sortDirection]="getSortDirection(column.key)"
              [onSort]="sortBy"
            ></th>
          }
        </tr>
      </thead>

      <tbody>
        @for (crypto of cryptos(); track crypto.id; let i = $index) {
          <tr
            class="border-t border-white/10 transition-colors hover:bg-white/15"
            [class.bg-white/5]="i % 2 === 0"
            [class.bg-white/10]="i % 2 !== 0"
          >
            <td class="px-4 py-2 max-w-[120px]" [title]="crypto.id">
              <div class="truncate-cell" [title]="crypto.id">
                {{ crypto.id }}
              </div>
            </td>
            <td class="px-4 py-2 max-w-[150px]" [title]="crypto.name">
              <div class="truncate-cell" [title]="crypto.name">
                {{ crypto.name }}
              </div>
            </td>
            <td class="px-4 py-2 whitespace-nowrap">{{ crypto.symbol | uppercase }}</td>
            <td class="px-4 py-2 text-right whitespace-nowrap">
              <app-formatted-price [value]="crypto.current_price" />
            </td>
            <td class="px-4 py-2 text-right whitespace-nowrap">
              {{
                crypto.market_cap !== null && crypto.market_cap !== undefined
                  ? (crypto.market_cap | number)
                  : '-'
              }}
            </td>
            <td class="px-4 py-2 text-right whitespace-nowrap">
              {{
                crypto.total_volume !== null && crypto.total_volume !== undefined
                  ? (crypto.total_volume | number)
                  : '-'
              }}
            </td>
            <td class="px-4 py-2 text-right whitespace-nowrap">
              <app-formatted-price [value]="crypto.high_24h" />
            </td>
            <td class="px-4 py-2 text-right whitespace-nowrap">
              <app-formatted-price [value]="crypto.low_24h" />
            </td>
            <td class="px-4 py-2 text-right whitespace-nowrap">
              {{
                crypto.price_change_percentage_24h !== null &&
                crypto.price_change_percentage_24h !== undefined
                  ? (crypto.price_change_percentage_24h | number: '1.2-2')
                  : '-'
              }}
            </td>
            <td class="px-4 py-2 text-right whitespace-nowrap">
              {{
                crypto.circulating_supply !== null && crypto.circulating_supply !== undefined
                  ? (crypto.circulating_supply | number)
                  : '-'
              }}
            </td>
          </tr>
        }
      </tbody>
    </table>
  }
</div>
